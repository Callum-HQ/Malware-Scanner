# pip install pyClamd

import clamd
import logging

# Set up logging
logging.basicConfig(filename='scan.log', level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')
#level represents severity level, in which here, it is INFO or higher that will be logged


def scan_file(filename):
    try:
        clam = clamd.ClamdUnixSocket()
        scan_result = clam.scan(filename)
        if scan_result:
            logging.warning(f"{filename} is infected with malware: {scan_result['stream']}")
            print(f"{filename} is infected with malware: {scan_result['stream']}")
        else:
            logging.info(f"{filename} is clean")
            print(f"{filename} is clean")
    except clamd.ConnectionError as e:
        logging.error(f"Failed to connect to ClamAV daemon: {e}")
        print(f"Failed to connect to ClamAV daemon: {e}")
    except clamd.ScanError as e:
        logging.error(f"Failed to scan file: {e}")
        print(f"Failed to scan file: {e}")
    except Exception as e:
        logging.error(f"An error occurred: {e}")
        print(f"An error occurred: {e}")

if __name__ == '__main__':
    filename = input("Enter the filename to scan: ")
    scan_file(filename)
